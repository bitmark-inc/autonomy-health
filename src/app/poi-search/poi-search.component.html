<div class="search-page">
  <mat-toolbar class="search-bar">
    <mat-icon matPrefix class="search-icon"><img src="/assets/img/search.svg" alt=""></mat-icon>
    <input [hidden]="resourceID" #placeSearchInput matInput type="text" [(ngModel)]="keyword" placeholder="Enter local name or address ..." class="search-input">
    <div [hidden]="!resourceID" class="search-input">
      <p class="resource-on-searching">{{resourceID}}</p>
    </div>
    <button mat-button *ngIf="keyword || resources" matSuffix mat-icon-button aria-label="Clear" (click)="clearAll()">
      <img src="/assets/img/clear-search.svg" alt="">
    </button>
  </mat-toolbar>
  <mat-card class="no-top no-bottom search-bar-line"><hr></mat-card>
  <div *ngIf="(!keyword) && (!resourceID)">
    <mat-card class="main-direction content-center no-bottom">
      <div class="p-t-20 p-b-20"><p>Find safe resources</p></div>
    </mat-card>
    <mat-card class="font-14 content-center">
      <p class="p-b-20">We can help you identify safe resources in and around the Berkeley community. Just tap one of the resource types below
      or enter a local name or address in the search field above.</p>
    </mat-card>
    <mat-card class="resources-list">
      <div class="resource-item font-14" *ngFor="let resource of resources"
        (click)="searchByResource(resource.id, resource.name)">
        {{resource.name}}
      </div>
    </mat-card>
  </div>
  <div class="p-t-20" *ngIf="keyword && placesByKeyword && placesByKeyword.length">
    <mat-card *ngFor="let place of placesByKeyword">
      <div class="place-found" (click)="navigateToPlace(place)">
        <p>{{place.name}}</p>
        <span class="small-address p-t-5">{{place.formatted_address}}</span>
      </div>
      <div class="p-t-20"><hr></div>
    </mat-card>
  </div>
  <div *ngIf="resourceID && poisByResource && poisByResource.length">
    <mat-card class="no-bottom" *ngFor="let place of poisByResource">
      <div class="place-found" (click)="navigateToPOI(place.id)">
        <p>{{place.alias}} ({{place.distance | number:'1.1-1'}}km)</p>
        <p class="small-address p-t-5">{{place.address}}</p>

        <div class="resource-score search-resource p-t-5">
          <mat-radio-group aria-labelledby="example-radio-group-label" class="example-radio-group" [(ngModel)]="place.resource_score">
            <div *ngIf="place.resource_score == 0" class="group-radios">
              <div class="default-color">
                <mat-radio-button class="example-radio-button" *ngFor="let i of [1,2,3,4,5]" [value]="i"></mat-radio-button>
              </div>
            </div>
            <div *ngIf="place.resource_score > 0 && place.resource_score <= 1" class="group-radios">
              <div class="risk-color">
                <mat-radio-button class="example-radio-button" [value]="1"></mat-radio-button>
              </div>
              <div class="default-color">
                <mat-radio-button class="example-radio-button" *ngFor="let i of [2,3,4,5]" [value]="i"></mat-radio-button>
              </div>
            </div>
            <div *ngIf="place.resource_score > 1 && place.resource_score <= 1.6" class="group-radios">
              <div class="risk-color">
                <mat-radio-button class="example-radio-button" *ngFor="let i of [1,2]" [value]="i"></mat-radio-button>
              </div>
              <div class="default-color">
                <mat-radio-button class="example-radio-button" *ngFor="let i of [3,4,5]" [value]="i"></mat-radio-button>
              </div>
            </div>
            <div *ngIf="place.resource_score > 1.6 && place.resource_score <= 2" class="group-radios">
              <div class="warn-color">
                <mat-radio-button class="example-radio-button" *ngFor="let i of [1,2]" [value]="i"></mat-radio-button>
              </div>
              <div class="default-color">
                <mat-radio-button class="example-radio-button" *ngFor="let i of [3,4,5]" [value]="i"></mat-radio-button>
              </div>
            </div>
            <div *ngIf="place.resource_score > 2 && place.resource_score <= 3" class="group-radios">
              <div class="warn-color">
                <mat-radio-button class="example-radio-button" *ngFor="let i of [1,2,3]" [value]="i"></mat-radio-button>
              </div>
              <div class="default-color">
                <mat-radio-button class="example-radio-button" *ngFor="let i of [4,5]" [value]="i"></mat-radio-button>
              </div>
            </div>
            <div *ngIf="place.resource_score > 3 && place.resource_score <= 3.3" class="group-radios">
              <div class="warn-color">
                <mat-radio-button class="example-radio-button" *ngFor="let i of [1,2,3,4]" [value]="i"></mat-radio-button>
              </div>
              <div class="default-color">
                <mat-radio-button class="example-radio-button" [value]="5"></mat-radio-button>
              </div>
            </div>
            <div *ngIf="place.resource_score > 3.3 && place.resource_score <= 4" class="group-radios">
              <div class="good-color">
                <mat-radio-button class="example-radio-button" *ngFor="let i of [1,2,3,4]" [value]="i"></mat-radio-button>
              </div>
              <div class="default-color">
                <mat-radio-button class="example-radio-button" [value]="5"></mat-radio-button>
              </div>
            </div>
            <div *ngIf="place.resource_score > 4 && place.resource_score <= 5" class="group-radios">
              <div class="good-color">
                <mat-radio-button class="example-radio-button" *ngFor="let i of [1,2,3,4,5]" [value]="i"></mat-radio-button>
              </div>
            </div>
          </mat-radio-group>
          <p *ngIf="place.resource_score" class="resource-rating" [innerHTML]="place.resource_score | reportScore"></p>
        </div>
      </div>
      <div class="p-t-10"><hr></div>
    </mat-card>
  </div>
  <mat-card class="non-places-found" *ngIf="resourceID && poisByResource && !poisByResource.length">
    <p>Sorry, there arenâ€™t currently any places in our system offering that resource. Be the first to add it for places you know!</p>
  </mat-card>
</div>
